<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="ico/favicon.png">

    <title>Tentacle: The Spawn of Cthulhu</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/grid.css" rel="stylesheet">

  </head>

  <body>
    <div class="container">
 
      <div class="page-header">
        <h1>Tentacle Server</h1>
        <p class="lead">The Spawn of Cthulhu</p>
      </div>

	<div id="spawn-detected"><button id="refresh" type="button" class="btn btn-success">New Spawn detected, click to refresh</button><br /><br /></div>
	
	<h3>
		<div class="input-group">
  			<span class="input-group-addon">Filter by Text</span>
  			<input id="filter-text" type="text" class="form-control" placeholder="text">
		</div>
	</h3>
	
	<div class="panel panel-default">	
		<table class="table" id="filter-table">
			<thead>
				<tr>
					<th>Host</th>
					<th>Operating System</th>
					<th class="text-right">Action</td></th>
				</tr>			
			</thead>
			<tbody id="filter-tbody">
			
			% if len(spawns) == 0:
				<tr><td colspan="4">No Spawn(s) found</td></tr>
			% endif
			% for spawn in spawns:
				<tr>
					<td>${spawn['spawn']['ipaddress']}:${spawn['spawn']['port']}&nbsp;(${spawn.steps()[0]['hostname']})</td>
					<td>${spawn.steps()[1]['platform']}</td>
					<td class="text-right">
						<button class="action-sent-msg btn-link" type="button">Send Msg</button>
					</td>
				</tr>
			% endfor
			</tbody>
			<tfoot>
				<tr>
					<td colspan="4">
					<p class="pull-right"><a href="https://github.com/mfriesen/tentacle">github source</a></p></td>
				</tr>
			</tfoot>
		</table>
	</div>
		
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-2.0.3.min.js"></script>
    <script src="js/index.js"></script>
    <script>

		var spawn_count = ${len(spawns)};
	
		function update_spawns() {

			$.getJSON( "/action/spawns", function( data ) {
				if (data.length != spawn_count) {
					$("#spawn-detected").show();
				}
			});
		}
	</script>

  </body>
</html>
